services:
  seq:
    image: datalust/seq:latest
    container_name: releasesync-seq
    environment:
      - ACCEPT_EULA=Y
      - SEQ_FIRSTRUN_ADMINUSERNAME=admin
      - SEQ_FIRSTRUN_ADMINPASSWORDHASH=${SEQ_ADMIN_PASSWORD_HASH:-}
    ports:
      - "5341:80"
    volumes:
      - seq-data:/data
    restart: unless-stopped

  releasesync:
    build:
      context: ./src
      dockerfile: ReleaseSync.Console/Dockerfile
    depends_on:
      - seq
    environment:
      - SEQ_SERVER_URL=http://seq:80
    volumes:
      - ./output:/app/output
      - ./dockerConfigs/appsettings.docker.json:/app/appsettings.json
      - ./dockerConfigs/google-service-account.json:/app/google-service-account.json

volumes:
  seq-data:
